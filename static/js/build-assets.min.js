var fs=require("fs"),zlib=require("zlib"),packer=function(e){var n,s,i,r,t,o,l,c=[],f=function(n){for(var e,s,i=[],r=fs.readdirSync(n).map(function(e){return n+"/"+e}),t=0,o=r.length;t<o;++t)e=r[t],fs.statSync(e).isDirectory()?i.push(f(e)):/\.(png|jpg|mp3)$/.exec(e)&&(s=fs.statSync(e).size,i.push(c.push([e,s])));return i};for(f(e),c.sort(function(e,n){return e[1]-n[1]}),console.log(c.map(function(e){return e[1]+" "+e[0]}).join("\n")),console.log("["+e+"] total size:",c.reduce(function(e,n){return e+n[1]},0)),n=c.map(function(e){return e[0]}),fs.writeFileSync("assets/"+e+"-filelist.json",JSON.stringify(n)),console.log("["+e+"] file list stored in "+e+"-filelist.json."),console.log("["+e+"] pack files..."),s={},i=0,r=n.length;i<r;++i)t=n[i],o=fs.readFileSync(t).toString("base64"),s[t]=o;return l=zlib.gzipSync(JSON.stringify(s)),console.log("hashed files compressed ( "+l.length+" bytes )"),fs.writeFileSync("assets/"+e+".gz",l),console.log("["+e+"] files packed in "+e+".gz")};packer("img"),packer("snd");